<!DOCTYPE html>
<html lang="en">
<head>
   <!-- Title -->
  {% if title %}
  <title>Schkit Pay - {{ title }}</title>
  {% else %}
  <title>Schkit Pay</title>
  {% endif %}

  <!-- Required Meta Tags Always Come First -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- jQuery and QuaggaJS libraries -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

   <!-- Favicon -->
  <link rel="shortcut icon" href="../../static/icons/favicon-96x96.png">

  <!-- Google Fonts -->
  <link href="//fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">

  <!-- CSS Implementing Plugins -->
  <link rel="stylesheet" href="../../static/wallet/vendor/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="../../static/wallet/vendor/animate.css/animate.min.css">
  <link rel="stylesheet" href="../../static/wallet/vendor/hs-megamenu/src/hs.megamenu.css">
  <link rel="stylesheet" href="../../static/wallet/vendor/malihu-custom-scrollbar-plugin/jquery.mCustomScrollbar.css">
  <link rel="stylesheet" href="../../static/vendor/animate.css/animate.min.css">
  <link rel="stylesheet" href="../../static/vendor/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="../../static/vendor/hs-mega-menu/dist/hs-mega-menu.min.css">
  <link rel="stylesheet" href="../../static/vendor/slick-carousel/slick/slick.css">
  <link rel="stylesheet" href="../../static/vendor/dzsparallaxer/dzsparallaxer.css">

  <!-- CSS Space Template -->
  <link rel="stylesheet" href="../../static/wallet/css/theme.css">
  <link rel="stylesheet" href="../../static/wallet/css/signin.css">
  <link rel="stylesheet" href="../../static/css/theme.css">
</head>

<body>

  <!-- ========== MAIN CONTENT ========== -->
<main class="js-validate form-signin p-5">
    <div class="d-flex justify-content-between align-items-center">
        {% if bank_card %}
        <a class="d-block mb-3 mb-sm-0" href="{% url 'profile' %}">
            <span class="fa fa-arrow-left mr-2"></span>
            Account
        </a>
        {% endif %}  
        <!-- Clickable Area for QR Code Scanner -->
        <div class="text-center mb-3 ml-auto" id="scan-area">
            <i class="fas fa-camera mr-2"></i>Scan
        </div>
        <!-- Hidden input for triggering camera -->
        <input type="file" accept="image/*" capture="environment" id="camera-input" style="display: none;">
        <!-- Video element for webcam stream -->
        <video id="camera-preview" style="display: none;"></video>

    </div>
    <br>
    <br>

    <div class="position-absolute bottom-0  right-0 max-w-50rem w-100 z-index-n1 mx-auto">
        <img class="img-fluid" src="../../static/svg/components/abstract-shapes-3.svg" alt="Image Description">
    </div>

    {% if bank_card %}
    {% else %}
    <div class="position-absolute bottom-0  right-0 max-w-50rem w-100 z-index-n1 mx-auto">
        <img class="img-fluid" src="../../static/svg/components/abstract-shapes-3.svg" alt="Image Description">
    </div>
    {% endif %}

    <div class="d-sm-flex justify-content-sm-between float-right">
        {% if bank_card %}
        <a class="d-block mb-3 mb-sm-0" href="{% url 'transfer' %}">
            <span class="fas fa-exchange-alt"></span>
            Transfer
        </a> 
        {% endif %}  
    </div>
    <br>
    <br>

    {% if card_holder %}
    {% for holder in card_holder %}
    <!-- Card -->
    <div class="card bg-img-hero py-4 px-5 mb-7 ie-d-block" style="background-image: url(../../static/wallet/svg/shapes/shape5.svg);">
        <div class="media align-items-center">
            <img class="max-width-10 mr-3" src="../../static/wallet/svg/components/request-quote-blue-icon.svg" alt="Image Description">
            <div class="media-body">
                {% if holder.hide_balance == True %}
                <h4 class="h3 text-blue mb-0"><strong>**** $USD</strong></h4>
                {% else %}
                <h4 class="h3 text-blue mb-0"><strong><span id="balance_amount">{{ total_balance }}</span> $USD</strong></h4>
                {% endif %}
                <p class="mb-0">Wallet balance</p>
            </div>
        </div>
    </div>
    <!-- End Card -->

    {% if bank_card %}
    <div class="mb-3">
        <a href="{% url 'top-up' %}">
            <button type="submit" class="btn btn-block btn-primary">Top Up</button>
        </a>
    </div>
    <div class="mb-3">
        <a href="{% url 'withdrew' %}">
            <button type="submit" class="btn btn-block btn-primary">Withdraw</button>
        </a>
    </div>
    {% else %}
    <div class="mb-3">
        <a href="{% url 'bank-card' %}">
            <button type="submit" class="btn btn-block btn-primary">
                <i><img src="../../static/wallet/images/card.png" alt=" " /></i>
                Link BankCard
            </button>
        </a>
    </div>
    {% endif %}
    {% endfor %}
    {% endif %}

    <div class="text-center mb-3">
        <p class="text-muted"><i class="fas fa-qrcode mr-2"></i> to pay <a href="{% url 'scan' %}">
            <span class="fa fa-arrow-right mr-2"></span>
        </a></p>
    </div>

    <p class="small text-center text-muted mb-0">Provided by &copy; Schkit</p>
</main>
<!-- ========== END MAIN CONTENT ========== -->

<!-- JS Global Compulsory -->
<script src="../../static/vendor/jquery/dist/jquery.min.js"></script>
<script src="../../static/vendor/jquery-migrate/dist/jquery-migrate.min.js"></script>
<script src="../../static/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

<!-- JS Implementing Plugins -->
<script src="../../static/vendor/hs-header/dist/hs-header.min.js"></script>
<script src="../../static/vendor/hs-go-to/dist/hs-go-to.min.js"></script>
<script src="../../static/vendor/hs-unfold/dist/hs-unfold.min.js"></script>
<script src="../../static/vendor/hs-mega-menu/dist/hs-mega-menu.min.js"></script>
<script src="../../static/vendor/hs-show-animation/dist/hs-show-animation.min.js"></script>
<script src="../../static/vendor/slick-carousel/slick/slick.js"></script>
<script src="../../static/vendor/dzsparallaxer/dzsparallaxer.js"></script>

<!-- JS Front -->
<script src="../../static/js/hs.core.js"></script>

<!-- HTML5 QR Code Scanner -->
<script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.0.2/dist/html5-qrcode.min.js"></script>

<!-- Custom Script -->
<script>
  $(document).ready(function () {
    $('#scan-area').on('click', function () {
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(function(stream) {
          // Set the stream to the video element
          $('#camera-preview').get(0).srcObject = stream;
          // Play the video
          $('#camera-preview').get(0).play();
        })
        .catch(function(err) {
          if (err.name === 'PermissionDeniedError') {
            console.error("User denied camera access");
            // Display a user-friendly message about permission needed
          } else {
            console.error("Error accessing camera:", err);
          }
        });
    });
  });
</script>

</body>
</html>
